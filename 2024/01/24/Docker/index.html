<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Docker, Anubis">
    <meta name="description" content="Docker 操作笔记">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Docker | Anubis</title>
    <link rel="icon" type="image/png" href="/medias/favicon2.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Anubis</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>常用链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Anubis</div>
        <div class="logo-desc">
            
            Anubis的个人博客
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			常用链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/AnubisCL" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>AnubisCL Profile
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #000000; /* TODO github logo color */
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/AnubisCL" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="AnubisCL Profile" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/markdownimages/background/animation/11.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Docker</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Docker/">
                                <span class="chip bg-color">Docker</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E9%83%A8%E7%BD%B2/" class="post-category">
                                部署
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-01-24
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2024-01-24
                </div>
                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="1-Docker安装"><a href="#1-Docker安装" class="headerlink" title="1.Docker安装"></a>1.Docker安装</h2><h3 id="1-1-安装Docker"><a href="#1-1-安装Docker" class="headerlink" title="1.1.安装Docker"></a>1.1.安装Docker</h3><blockquote>
<p>环境查看</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 系统内核是3.10以上的</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># uname -r</span>
<span class="token number">3.10</span>.0-1127.el7.x86_64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 系统版本</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/os-release </span>
<span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">"CentOS Linux"</span>
<span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token string">"7 (Core)"</span>
<span class="token assign-left variable">ID</span><span class="token operator">=</span><span class="token string">"centos"</span>
<span class="token assign-left variable">ID_LIKE</span><span class="token operator">=</span><span class="token string">"rhel fedora"</span>
<span class="token assign-left variable">VERSION_ID</span><span class="token operator">=</span><span class="token string">"7"</span>
<span class="token assign-left variable">PRETTY_NAME</span><span class="token operator">=</span><span class="token string">"CentOS Linux 7 (Core)"</span>
<span class="token assign-left variable">ANSI_COLOR</span><span class="token operator">=</span><span class="token string">"0;31"</span>
<span class="token assign-left variable">CPE_NAME</span><span class="token operator">=</span><span class="token string">"cpe:/o:centos:centos:7"</span>
<span class="token assign-left variable">HOME_URL</span><span class="token operator">=</span><span class="token string">"https://www.centos.org/"</span>
<span class="token assign-left variable">BUG_REPORT_URL</span><span class="token operator">=</span><span class="token string">"https://bugs.centos.org/"</span>

<span class="token assign-left variable">CENTOS_MANTISBT_PROJECT</span><span class="token operator">=</span><span class="token string">"CentOS-7"</span>
<span class="token assign-left variable">CENTOS_MANTISBT_PROJECT_VERSION</span><span class="token operator">=</span><span class="token string">"7"</span>
<span class="token assign-left variable">REDHAT_SUPPORT_PRODUCT</span><span class="token operator">=</span><span class="token string">"centos"</span>
<span class="token assign-left variable">REDHAT_SUPPORT_PRODUCT_VERSION</span><span class="token operator">=</span><span class="token string">"7"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>安装Docker</p>
</blockquote>
<p>帮助文档：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、卸载旧的Docker版本</span>
<span class="token function">sudo</span> yum remove <span class="token function">docker</span> <span class="token punctuation">\</span>
                  docker-client <span class="token punctuation">\</span>
                  docker-client-latest <span class="token punctuation">\</span>
                  docker-common <span class="token punctuation">\</span>
                  docker-latest <span class="token punctuation">\</span>
                  docker-latest-logrotate <span class="token punctuation">\</span>
                  docker-logrotate <span class="token punctuation">\</span>
                  docker-engine
<span class="token comment"># 2、需要的安装包</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils

<span class="token comment">#3、设置镜像的仓库</span>
<span class="token comment"># 默认是国外的下载超级慢！</span>
<span class="token function">sudo</span> yum-config-manager <span class="token punctuation">\</span> --add-repo <span class="token punctuation">\</span> https://download.docker.com/linux/centos/docker-ce.repo 

<span class="token comment"># 阿里云的镜像</span>
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

<span class="token comment"># 更新yum软件包索引</span>
yum makecache fast

<span class="token comment"># 4、安装docker相关的软件 docker-ce社区版 docker-ee企业版</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce docker-ce-cli containerd.io <span class="token parameter variable">-y</span>

<span class="token comment"># 5、启动docker</span>
<span class="token function">sudo</span> systemctl start <span class="token function">docker</span>

<span class="token comment"># 6、测试docker安装成功？</span>
<span class="token function">docker</span> version

<span class="token comment"># 7、永远的 [HelloWorld] ^_^ 能够成功拉取image表示docker安装成功！</span>
<span class="token function">docker</span> run hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># docker踩到的坑:运行[docker run hello-world]遇到的坑？会报错？</span>
docker: Error response from daemon: Get https://registry-1.docker.io/v2/library/hello-world/manifests/latest: Get https://auth.docker.io/token?scope<span class="token operator">=</span>repository%3Alibrary%2Fhello-world%3Apull<span class="token operator">&amp;</span><span class="token assign-left variable">service</span><span class="token operator">=</span>registry.docker.io: net/http: TLS handshake timeout.

<span class="token comment"># 解决办法：在/etc/docker下创建daemon.json文件。拷贝如下代码:</span>
<span class="token punctuation">&#123;</span>
  <span class="token string">"registry-mirrors"</span>:<span class="token punctuation">[</span><span class="token string">"https://registry.docker-cn.com"</span>,<span class="token string">"http://hub-mirror.c.163.com"</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span class="token comment"># 保存退出！</span>
<span class="token comment"># 重启docker服务：service docker restart</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>卸载Docker</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、卸载依赖</span>
<span class="token function">sudo</span> yum remove docker-ce docker-ce-cli containerd.io

<span class="token comment"># 2、删除资源</span>
<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker

<span class="token comment"># /var/lib/docker是Docker默认的工作路径！！！</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-2-阿里云镜像加速"><a href="#1-2-阿里云镜像加速" class="headerlink" title="1.2.阿里云镜像加速"></a>1.2.阿里云镜像加速</h3><blockquote>
<p>设置阿里云镜像步骤</p>
</blockquote>
<p>1、登录 [阿里云—&gt;控制台] 找到容器服务。</p>
<p><img src="/markdownimages/Docker/1.png" alt="阿里云"></p>
<p>2、找到镜像加速地址。</p>
<p><img src="/markdownimages/Docker/2.png" alt="镜像加速"></p>
<p>3、配置加速器使用</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/docker

<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
&#123;
  "registry-mirrors": ["https://phapqiqc.mirror.aliyuncs.com"]
&#125;
EOF</span>

<span class="token function">sudo</span> systemctl daemon-reload

<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>docker run 的运行流程图</p>
</blockquote>
<p><img src="/markdownimages/Docker/3.png" alt="docker运行流程"></p>
<h3 id="1-3-底层原理"><a href="#1-3-底层原理" class="headerlink" title="1.3.底层原理"></a>1.3.底层原理</h3><blockquote>
<p>docker是怎么工作的？</p>
</blockquote>
<p>Docker是一个Client-Server结构的系统，Docker的守护进程运行在主机上，通过Socket从客户端访问。</p>
<p>Docker-Server接收到Docker-Client的指令，就会执行这个命令。</p>
<p><img src="/markdownimages/Docker/4.png" alt="docker底层原理"></p>
<blockquote>
<p>docker为什么比VM快？</p>
</blockquote>
<p>1、Docker有着比虚拟机更少的抽象层。</p>
<p>2、Docker利用的是宿主机的内核。所以说新建一个容器的时候，docker不需要像虚拟机一样重新加载个操作系统内核。</p>
<h2 id="2-Docker的常用命令"><a href="#2-Docker的常用命令" class="headerlink" title="2.Docker的常用命令"></a>2.Docker的常用命令</h2><h3 id="2-1-帮助命令"><a href="#2-1-帮助命令" class="headerlink" title="2.1.帮助命令"></a>2.1.帮助命令</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> version	<span class="token comment">#显示docker的版本信息</span>
<span class="token function">docker</span> info		<span class="token comment">#显示Docker的系统信息，包括镜像和容器的数量</span>
<span class="token function">docker</span> <span class="token punctuation">[</span>命令<span class="token punctuation">]</span> <span class="token parameter variable">--help</span>	<span class="token comment">#docker帮助信息</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Docker帮助文档地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/">https://docs.docker.com/reference/</a></p>
<h3 id="2-2-镜像命令"><a href="#2-2-镜像命令" class="headerlink" title="2.2.镜像命令"></a>2.2.镜像命令</h3><blockquote>
<p>docker imag	s  查看所有本地的主机上的镜像</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
hello-world         latest              bf756fb1ae65        <span class="token number">5</span> months ago        <span class="token number">13</span>.3kB

<span class="token comment">#解释</span>
REPOSITORY	 镜像的仓库源
TAG			镜像的标签
IMAGE ID	 镜像的ID
CREATED		 镜像的创建时间
SIZE		 镜像的大小

<span class="token comment">#可选项</span>
  -a, <span class="token parameter variable">--all</span>             <span class="token comment">#列出所有的镜像</span>
  -q, <span class="token parameter variable">--quiet</span>           <span class="token comment">#只显示镜像的id</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>docker search   去dockerhub搜索镜像</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker search mysql</span>

<span class="token comment">#可选项</span>
<span class="token parameter variable">--filter</span><span class="token operator">=</span>stars<span class="token operator">=</span><span class="token number">3000</span>	<span class="token comment">#搜索出来的镜像就是stars大于3000的</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker search nginx --filter=stars=3000</span>
NAME                DESCRIPTION                STARS               OFFICIAL            AUTOMATED
nginx               Official build of Nginx.   <span class="token number">13323</span>               <span class="token punctuation">[</span>OK<span class="token punctuation">]</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>docker poll	下载镜像</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 下载镜像 docker pull [镜像名] [:tag]</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql</span>
Using default tag: latest <span class="token comment"># 如果不写tag，默认就下载lastest最新版本</span>
latest: Pulling from library/mysql
8559a31e96f4: Pull complete <span class="token comment"># 分层下载，docker image的核心，联合文件系统</span>
d51ce1c2e575: Pull complete 
c2344adc4858: Pull complete 
fcf3ceff18fc: Pull complete 
16da0c38dc5b: Pull complete 
b905d1797e97: Pull complete 
4b50d1c6b05c: Pull complete 
c75914a65ca2: Pull complete 
1ae8042bdd09: Pull complete 
453ac13c00a3: Pull complete 
9e680cd72f08: Pull complete 
a6b5dc864b6c: Pull complete 
Digest: sha256:8b7b328a7ff6de46ef96bcf83af048cb00a1c86282bfca0cb119c84568b4caf6 <span class="token comment"># 签名(防伪标志)</span>
Status: Downloaded newer image <span class="token keyword">for</span> mysql:latest
docker.io/library/mysql:latest <span class="token comment"># 真实地址</span>

<span class="token comment">#等价于</span>
<span class="token function">docker</span> pull mysql
<span class="token function">docker</span> pull docker.io/library/mysql:latest

<span class="token comment">#指定版本下载 </span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql:5.7</span>
<span class="token number">5.7</span>: Pulling from library/mysql
8559a31e96f4: Already exists <span class="token comment"># 下载的mysql5.7和之前下载的mysql可以部分文件可以共用</span>
d51ce1c2e575: Already exists 
c2344adc4858: Already exists 
fcf3ceff18fc: Already exists 
16da0c38dc5b: Already exists 
b905d1797e97: Already exists 
4b50d1c6b05c: Already exists 
d85174a87144: Pull complete 
a4ad33703fa8: Pull complete 
f7a5433ce20d: Pull complete 
3dcd2a278b4a: Pull complete 
Digest: sha256:32f9d9a069f7a735e28fd44ea944d53c61f990ba71460c5c183e610854ca4854
Status: Downloaded newer image <span class="token keyword">for</span> mysql:5.7
docker.io/library/mysql:5.7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>docker rmi	删除image</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 根据image ID删除指定的image</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker rmi -f 9cfcce23593a</span>
Untagged: mysql:5.7
Untagged: mysql@sha256:32f9d9a069f7a735e28fd44ea944d53c61f990ba71460c5c183e610854ca4854
Deleted: sha256:9cfcce23593a93135ca6dbf3ed544d1db9324d4c40b5c0d56958165bfaa2d46a
Deleted: sha256:98de3e212919056def8c639045293658f6e6022794807d4b0126945ddc8324be
Deleted: sha256:17e8b88858e400f8c5e10e7cb3fbab9477f6d8aacba03b8167d34a91dbe4d8c1
Deleted: sha256:c04c087c2af9abd64ba32fe89d65e6d83da514758923de5da154541cc01a3a1e
Deleted: sha256:ab8bf065b402b99aec4f12c648535ef1b8dc954b4e1773bdffa10ae2027d3e00

<span class="token comment"># 递归删除所有image</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker rmi -f $(docker images -aq)</span>

<span class="token comment">#删除多个image</span>
<span class="token function">docker</span> rmi <span class="token parameter variable">-f</span> <span class="token punctuation">[</span>image id1<span class="token punctuation">]</span> <span class="token punctuation">[</span>image id2<span class="token punctuation">]</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-3-容器命令"><a href="#2-3-容器命令" class="headerlink" title="2.3.容器命令"></a>2.3.容器命令</h3><p><strong>说明：我们有了image才可以创建容器，下载一个centos镜像来测试和学习。</strong></p>
<blockquote>
<p>docker run	新建容器并启动</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull centos:7

<span class="token comment"># docker run [可选参数] image</span>

<span class="token comment"># 参数说明</span>
<span class="token parameter variable">--name</span><span class="token operator">=</span><span class="token string">"Name"</span>   <span class="token comment"># 给容器取名字</span>
<span class="token parameter variable">-d</span>				<span class="token comment"># 后台运行容器并且输出容器的id</span>
<span class="token parameter variable">-it</span>				<span class="token comment"># 使用交互方式运行，进入容器查看内容</span>
<span class="token parameter variable">-p</span>				<span class="token comment"># (小写的p)容器的端口和Linux主机端口的映射 </span>
	<span class="token parameter variable">-p</span> 主机端口:容器端口<span class="token punctuation">(</span>常用<span class="token punctuation">)</span>
	<span class="token parameter variable">-p</span> ip:主机端口:容器端口
	
<span class="token parameter variable">-P</span>				<span class="token comment"># (大写的P)随机指定端口</span>

<span class="token comment"># 测试，启动centos image并进入容器</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker run -it --name="centos-test1" 470671670cac /bin/bash</span>
<span class="token punctuation">[</span>root@91f0881f5e49 /<span class="token punctuation">]</span><span class="token comment"># ls </span>
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr

<span class="token comment"># 退出容器命令</span>
<span class="token punctuation">[</span>root@91f0881f5e49 /<span class="token punctuation">]</span><span class="token comment"># exit</span>
<span class="token builtin class-name">exit</span>
<span class="token punctuation">[</span>root@centos-7-test1 /<span class="token punctuation">]</span><span class="token comment"># ls</span>
bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>docker ps	列出所有的容器</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 列出所有正在运行的容器</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token punctuation">[</span>可选参数<span class="token punctuation">]</span>

<span class="token comment"># 可选参数</span>
<span class="token parameter variable">-a</span>	<span class="token comment"># 列出所有的容器(包括历史运行的容器)</span>
<span class="token parameter variable">-n</span>	<span class="token comment"># 显示n个最后创建的容器</span>
<span class="token parameter variable">-q</span> 	<span class="token comment"># 只显示容器的id</span>

<span class="token comment"># 显示最后一个创建的容器</span>
<span class="token punctuation">[</span>root@centos-7-test1 /<span class="token punctuation">]</span><span class="token comment"># docker ps -n=1</span>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS               NAMES
91f0881f5e49        470671670cac        <span class="token string">"/bin/bash"</span>         <span class="token number">11</span> minutes ago      Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">8</span> minutes ago                       centos-test1

<span class="token comment"># 列出所有的容器(包括历史运行的容器)</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>退出容器</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">exit</span>	<span class="token comment"># 直接退出容器并退出</span>
ctrl + P + Q 	<span class="token comment"># 容器不停止退出</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p>docker rm	删除容器</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 按照容器id删除容器 不能删除正在运行的容器，如果要强制删除，需要使用 rm -f</span>
<span class="token function">docker</span> <span class="token function">rm</span> <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span>

<span class="token comment"># 删除所有容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-aq</span><span class="token variable">)</span></span>

<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-aq</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">docker</span> <span class="token function">rm</span>		<span class="token comment"># 删除所有的容器</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>启动和停止容器的操作</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> start <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span>		<span class="token comment"># 启动容器</span>
<span class="token function">docker</span> restart <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span>	<span class="token comment"># 重新启动容器</span>
<span class="token function">docker</span> stop <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span> 		<span class="token comment"># 停止当前正在运行的容器</span>
<span class="token function">docker</span> <span class="token function">kill</span> <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span>		<span class="token comment"># 强制停止运行容器</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-4-其他常用命令"><a href="#2-4-其他常用命令" class="headerlink" title="2.4.其他常用命令"></a>2.4.其他常用命令</h3><blockquote>
<p>后台启动容器</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># docker run -d [image]</span>

<span class="token comment"># 问题：docker ps 之后，返现容器停止运行了？why？</span>

<span class="token comment"># 常见的坑，docker 容器使用后台运行，就必须要有一个前台的进程，docker发现没有应用，就会自动停止。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>查看日志</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> logs <span class="token parameter variable">-f</span> <span class="token parameter variable">-t</span> <span class="token parameter variable">--tail</span> <span class="token punctuation">[</span>number<span class="token punctuation">]</span> <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span>

<span class="token comment"># 参数说明</span>
<span class="token parameter variable">-f</span>	<span class="token comment"># 跟踪日志输出</span>
<span class="token parameter variable">-t</span>	<span class="token comment"># 显示时间戳</span>
<span class="token parameter variable">--tail</span>	<span class="token comment"># 显示最近number条日志</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>查看容器中进程信息</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">top</span> <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span>

<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker top db1f61a0c5c9</span>
<span class="token environment constant">UID</span>                 PID                 <span class="token environment constant">PPID</span>                C                   STIME               TTY      root                <span class="token number">7196</span>                <span class="token number">7177</span>                <span class="token number">0</span>                   <span class="token number">22</span>:33               pts/0   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>查看容器的元数据</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> inspect <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>进入当前正在运行的容器</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 容器通常都是后台运行的，需要进入容器 </span>

<span class="token comment"># 方式一：docker exec</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span> <span class="token punctuation">[</span>bashshell<span class="token punctuation">]</span>

<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it db1f61a0c5c9 /bin/bash</span>
<span class="token punctuation">[</span>root@db1f61a0c5c9 /<span class="token punctuation">]</span><span class="token comment"># ls</span>
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr 

<span class="token comment"># 方式二：docker attach</span>
<span class="token function">docker</span> attach <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span>

<span class="token comment"># 问题：docker exec 和 docker attach 的区别？</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span>		<span class="token comment"># 进入容器后开启一个新的终端，exit后不会关闭容器(常用)</span>
<span class="token function">docker</span> attach 	<span class="token comment"># 进入容器正在执行的终端，不会启动新的进程，exit后容器会stop。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>从容器内拷贝文件到主机上</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 命令docker cp</span>
<span class="token function">docker</span> <span class="token function">cp</span> containerID:容器内路径 目的主机路径


<span class="token comment"># 测试将centos容器内 /etc/profile 文件拷贝到主机 /opt/ 目录下</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker ps </span>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS    db1f61a0c5c9        470671670cac        <span class="token string">"/bin/bash"</span>         <span class="token number">25</span> minutes ago      Up <span class="token number">2</span> minutes                            
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># docker cp db1f61a0c5c9:/etc/profile /opt/</span>
<span class="token punctuation">[</span>root@centos-7-test1 ~<span class="token punctuation">]</span><span class="token comment"># cd /opt/</span>
<span class="token punctuation">[</span>root@centos-7-test1 opt<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">4</span>
drwxr-xr-x. <span class="token number">3</span> root root   <span class="token number">72</span> Jun <span class="token number">11</span> <span class="token number">14</span>:53 activemq
drwx--x--x. <span class="token number">4</span> root root   <span class="token number">28</span> Jun <span class="token number">12</span> <span class="token number">16</span>:01 containerd
drwxr-xr-x. <span class="token number">3</span> root root   <span class="token number">60</span> Jun <span class="token number">11</span> <span class="token number">10</span>:20 <span class="token function">java</span>
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">2078</span> Sep <span class="token number">10</span>  <span class="token number">2018</span> profile
drwxr-xr-x. <span class="token number">2</span> root root    <span class="token number">6</span> Oct <span class="token number">31</span>  <span class="token number">2018</span> rh
drwxr-xr-x. <span class="token number">3</span> root root   <span class="token number">61</span> Jun <span class="token number">11</span> <span class="token number">10</span>:23 zookeeper<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-5-小结"><a href="#2-5-小结" class="headerlink" title="2.5.小结"></a>2.5.小结</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">attach	Attach to a running container            		<span class="token comment"># 当前shell下进入到指定的正在运行的container中</span>
build 	Build an image from a Dockerfile           		<span class="token comment"># 通过Dockerfile构建镜像</span>
commit	Create a new image from a container‘s changes		<span class="token comment"># 提交当前容器为新的镜像</span>
<span class="token function">cp</span>   	Copy files/folders between a container and the <span class="token builtin class-name">local</span> filesystem		<span class="token comment"># 从容器中拷贝文件到宿主机指定路径</span>
create	Create a new container							<span class="token comment"># 创建一个新的容器,同run，但是不会启动容器</span>
<span class="token function">diff</span>	Inspect changes to <span class="token function">file</span> on container 			<span class="token comment"># 查看容器文件的变化</span>
events 	Get real <span class="token function">time</span> events from the server			<span class="token comment"># 从docker服务获取容器实时事件</span>
<span class="token builtin class-name">exec</span>	Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> a running container			<span class="token comment"># 在一个已经运行的容器内执行命令</span>
<span class="token builtin class-name">export</span>	Export a container’s filesystem as a <span class="token function">tar</span> archive	<span class="token comment"># 导出容器的内容流作为一个tar归档文件[对应 import]</span>
<span class="token function">history</span>	show the <span class="token function">history</span> of an image					<span class="token comment"># 展示一个镜像形成历史</span>
images	List images										<span class="token comment"># 列出系统中当前的镜像</span>
<span class="token function">import</span>	Import the contents form a tarball to create a filesystem image	<span class="token comment"># 从tar包中的内容创建一个新的文件系统镜像[对应 export]</span>
info	Display system-wide information					<span class="token comment"># 展示出系统相关信息</span>
inspect	Return low-level information on a container		<span class="token comment"># 查看容器详细信息</span>
<span class="token function">kill</span>	<span class="token function">kill</span> one or <span class="token function">more</span> running containers				<span class="token comment"># 强制停止一个或多个正在运行的容器</span>
load	load an image from a <span class="token function">tar</span> archive				<span class="token comment"># 从一个tar包中加载镜像[对应 save]</span>
login	Registy or login to the <span class="token function">docker</span> registry server	<span class="token comment"># 注册或者登陆一个docker源服务器</span>
<span class="token builtin class-name">logout</span>	Logout from a Docker registy server				<span class="token comment"># 从当前的docker registry server退出</span>
logs	Fetch the logs of a container					<span class="token comment"># 显示容器的日志</span>
port	show port mappings <span class="token keyword">for</span> a container				<span class="token comment"># 查看容器端口的映射</span>
pause	Pause all process within the container			<span class="token comment"># 暂停容器</span>
<span class="token function">ps</span>  	List containers									<span class="token comment"># 列出当前系统中的容器列表</span>
pull	Pull an image from a registry					<span class="token comment"># 从docker源服务器中拉取镜像</span>
push	Push an image or repository to a registry 		<span class="token comment"># 推送指定镜像或镜像库到docker源服务器</span>
restart	Restart one or <span class="token function">more</span> containers					<span class="token comment"># 重启一个或多个容器</span>
stop	Stop one or <span class="token function">more</span> running containers				<span class="token comment"># 停止一个或多个正在运行的容器</span>
tag   	Tag an image into a repository             		<span class="token comment"># 给源镜像中打标签</span>
<span class="token function">top</span>   	Display the running process of a container		<span class="token comment"># 展示容器中正在运行的进程列表</span>
unpause	Unpause all processes within a container		<span class="token comment"># 取消暂停容器</span>
version	Show the <span class="token function">docker</span> version information     		<span class="token comment"># 展示Docker版本信息</span>
<span class="token function">wait</span>	Block <span class="token keyword">until</span> one or <span class="token function">more</span> containers stop,then print their <span class="token builtin class-name">exit</span> codes		<span class="token comment"># 截取容器停止时的退出状态</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-6-Docker容器内存配置"><a href="#2-6-Docker容器内存配置" class="headerlink" title="2.6.Docker容器内存配置"></a>2.6.Docker容器内存配置</h3><blockquote>
<p>docker内存限制有两种方式：</p>
<ol>
<li>创建容器时添加-m参数，单位可以是b,k,m,g</li>
<li>如果已经存在容器，修改该容器的hostconfig.json文件</li>
</ol>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 方式一:-m参数限制</span>
<span class="token comment"># 创建容器时我们可以添加-m参数限制容器的内存占用。单位是b,k,m,b 例如:</span>
<span class="token comment"># 创建mysql的镜像实例，并限制容器占用内存大小为400m</span>
<span class="token function">docker</span> run <span class="token parameter variable">-dit</span> <span class="token parameter variable">--name</span> <span class="token builtin class-name">test</span> <span class="token parameter variable">-m</span> 400m <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 mysql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 方式二:修改hostconfig.json文件限制</span>
hostconfig.hson文件是容器的配置文件，每一个容器都有一个对应的 hostconfig.json配置文件，我们在创建容器时使用的任何参数，都可以在这里配置,功能十分的强劲。

<span class="token comment"># 1.查找容器对应的hostconfig.json文件</span>
<span class="token function">docker</span> <span class="token function">ps</span>  <span class="token comment">#找到要修改的容器id，记住它，后面要根据这个id找文件夹</span>
<span class="token function">find</span> / <span class="token parameter variable">-name</span> hostconfig.json <span class="token comment">#全局搜索hostconfig.json文件，文件的最后一级目录就是容器id</span>
<span class="token comment"># 通过上面的命令，就可以找到容器对应的hostconfig.json文件了。</span>

<span class="token comment"># 2.停止docker</span>
<span class="token comment"># 在修改hostconfig.json文件前，必须要停止docker，否则修改无效</span>
systemctl stop <span class="token function">docker</span>

<span class="token comment"># 3.修改hostconfig.json文件</span>
<span class="token comment"># 通过vi命令修改配置文件，找到Memory这一项，修改内存大小。请注意：这里的单位默认为byte。最小内存限制为4m，也就是，4x1024x1024。我这里修改为700mb，也就是700x1024x1024。修改完成之后保存退出。</span>

<span class="token comment"># 4.启动docker</span>
systemctl start <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="3-Docker镜像"><a href="#3-Docker镜像" class="headerlink" title="3.Docker镜像"></a>3.Docker镜像</h2><h3 id="3-1-镜像是什么？"><a href="#3-1-镜像是什么？" class="headerlink" title="3.1.镜像是什么？"></a>3.1.镜像是什么？</h3><p>镜像是一种轻量级，可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。</p>
<p>所有的应用直接打包成为Docker镜像，就可以直接跑起来！</p>
<p>如何得到镜像：</p>
<ul>
<li>从远程仓库下载。</li>
<li>朋友拷贝给你。</li>
<li>自己制作镜像DockerFile。</li>
</ul>
<h3 id="3-2-Docker镜像加载原理"><a href="#3-2-Docker镜像加载原理" class="headerlink" title="3.2.Docker镜像加载原理"></a>3.2.Docker镜像加载原理</h3><blockquote>
<p>UnionFS（联合文件系统）</p>
</blockquote>
<p>UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持対文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。Union文件系统是Docker镜像的基础。镜像可以通过分层来继承，基于基础镜像，可以制作各种具体的应用镜像。</p>
<p>特性：一次同时加载多个文件系统，但是从外面看来，只能看到一个文件系统，联合加载会把各层文件叠加起来，这样最终的文件系统会包含所有底层的文件和目录。</p>
<blockquote>
<p>镜像加载原理</p>
</blockquote>
<ul>
<li><p>docker 的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS。</p>
</li>
<li><p>bootfs(boot file system) 主要包含bootloader和kernel，bootloader 主要是引导加载kernel，Linux刚启动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux&#x2F;Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就存在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。</p>
</li>
<li><p>roorfs （root file system），在bootfs之上。包含的就是典型Linux系统中的 &#x2F;dev ，&#x2F;proc，&#x2F;bin ，&#x2F;etx 等标准的目录和文件。rootfs就是各种不同的操作系统发行版。比如Ubuntu，Centos等等。</p>
</li>
<li><p>对于一个精简的OS，rootfs可以很小，只需要包括最基本的命令、工具和程序库就可以了，因为底层直接用Host（宿主机）的kernel，自己只需要提供rootfs就行了，由此可见对于不同的Linux发行版，bootfs基本是一致的，rootfs会有差别，因此不同的发行版可以公用bootfs。</p>
</li>
</ul>
<p><img src="/markdownimages/Docker/5.png" alt="Docker镜像联合文件系统"></p>
<blockquote>
<p>镜像分层</p>
</blockquote>
<ul>
<li>所有的Docker镜像都起始于一个基础的镜像层，当进行修改或增加新的内容时，就会在当前的镜像层上，创建新的镜像层。</li>
<li>举一个简单的例子，例如基于CentOS7创建新的镜像，这就是镜像的第一层，如果在该镜像中添加<code>Java</code>包，就会在基础镜像层上创建第二个镜像层；如果继续添加一个安全补丁，就会创建第三个镜像层。</li>
</ul>
<p><img src="/markdownimages/Docker/6.png" alt="容器分层"></p>
<h3 id="3-3-Commit镜像"><a href="#3-3-Commit镜像" class="headerlink" title="3.3.Commit镜像"></a>3.3.Commit镜像</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> commit 提交容器成为一个新的镜像

<span class="token comment"># docker commit基本语法</span>
<span class="token function">docker</span> commit <span class="token parameter variable">-m</span><span class="token operator">=</span><span class="token string">"描述信息"</span> <span class="token parameter variable">-a</span><span class="token operator">=</span><span class="token string">"作者名字"</span> 目标镜像ID:<span class="token punctuation">[</span>TAG<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-容器数据卷"><a href="#4-容器数据卷" class="headerlink" title="4.容器数据卷"></a>4.容器数据卷</h2><h3 id="4-1-什么是容器数据卷"><a href="#4-1-什么是容器数据卷" class="headerlink" title="4.1.什么是容器数据卷"></a>4.1.什么是容器数据卷</h3><ul>
<li>将应用和环境打包成一个镜像！数据？如果数据都在容器中，那么我们将容器删除，数据就会消失。</li>
<li>需求：为了解决数据持久化的问题，可以容器数据存储在本地磁盘中，容器之间可以有一个数据共享的技术！</li>
<li>Docker容器中的数据可以同步到本地，删除容器后数据不会丢失，这就是容器数据卷技术。</li>
<li><strong>一句话：容器的数据的持久化和容器间数据的共享。</strong></li>
</ul>
<h3 id="4-2-使用数据卷"><a href="#4-2-使用数据卷" class="headerlink" title="4.2.使用数据卷"></a>4.2.使用数据卷</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># -v的基本使用</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> 主机端口:容器内端口 <span class="token parameter variable">-v</span> 主机目录:容器目录 镜像id

<span class="token comment"># 查看容器数据卷的挂载状态</span>
<span class="token function">docker</span> inspect 容器id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-3-安装MySQL"><a href="#4-3-安装MySQL" class="headerlink" title="4.3.安装MySQL"></a>4.3.安装MySQL</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">--name</span> mysql <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/mysql/conf:/etc/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">333</span> <span class="token punctuation">\</span>
mysql:5.7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-3-1-MySQL8"><a href="#4-3-1-MySQL8" class="headerlink" title="4.3.1. MySQL8"></a>4.3.1. MySQL8</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token punctuation">\</span>
    <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token punctuation">\</span>
    <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">333</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /root/mysql8/data:/var/lib/mysql <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /root/mysql8/log:/var/log/mysql <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /root/mysql8/config:/etc/mysql <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /etc/localtime:/etc/localtime <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /root/mysql8/mysql-files:/var/lib/mysql-files <span class="token punctuation">\</span>
    <span class="token parameter variable">--name</span> mysql8 <span class="token punctuation">\</span>
    <span class="token parameter variable">-d</span> mysql:8.0.26<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-4-具名挂载和匿名挂载"><a href="#4-4-具名挂载和匿名挂载" class="headerlink" title="4.4.具名挂载和匿名挂载"></a>4.4.具名挂载和匿名挂载</h3><blockquote>
<p>匿名挂载和具名挂载展示</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、匿名挂载</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--name</span> nginx01 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /etc/nginx <span class="token punctuation">\</span>
nginx:6.1

<span class="token comment"># 查看所有的volume情况</span>
<span class="token function">docker</span> volume <span class="token function">ls</span>

<span class="token punctuation">[</span>root@mingyu bin<span class="token punctuation">]</span><span class="token comment"># docker volume ls</span>
DRIVER              VOLUME NAME
<span class="token builtin class-name">local</span>               6831db4e060f8452a51fc56b52af0605c944bb0ab16c778a96469233794783ea

<span class="token comment"># 发现VOLUME NAME这里是一串乱码，这就是匿名挂载，我们在-v时只写了容器内的路径，没有写容器外的路径。</span>

<span class="token comment"># 2、具名挂载(-v 卷名:容器内路径) 注意这里是卷名而不是容器外路径</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3307</span>:3306 <span class="token parameter variable">--name</span> mysql-test <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> mysql-volume:/etc/mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">333</span> <span class="token punctuation">\</span>
mysql:5.7

<span class="token comment"># 查看具名挂载卷的位置</span>
<span class="token punctuation">[</span>root@mingyu bin<span class="token punctuation">]</span><span class="token comment"># docker inspect mysql-test</span>
<span class="token string">"Mounts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
<span class="token punctuation">&#123;</span>
<span class="token string">"Type"</span><span class="token builtin class-name">:</span> <span class="token string">"volume"</span>,
<span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"mysql-volume"</span>,
<span class="token string">"Source"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/volumes/mysql-volume/_data"</span>,
<span class="token string">"Destination"</span><span class="token builtin class-name">:</span> <span class="token string">"/etc/mysql"</span>,
<span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,
<span class="token string">"Mode"</span><span class="token builtin class-name">:</span> <span class="token string">"z"</span>,
<span class="token string">"RW"</span><span class="token builtin class-name">:</span> true,
<span class="token string">"Propagation"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
<span class="token punctuation">&#125;</span>,<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>所有的Docker容器的容器卷，没有指定目录的情况下都是在<code>/var/lib/docker/volumes/xxx/_data</code>。</p>
<p>我们通过具名挂载可以方便的找到我们的一个卷，大多数情况在使用的<code>具名挂载</code>。</p>
<blockquote>
<p>如何区分匿名挂载，还是具名挂载，还是指定路径挂载？</p>
</blockquote>
<ul>
<li>匿名挂载：<code>-v 容器内路径</code>。</li>
<li>具名挂载：<code>-v 卷名:容器内路径</code>。</li>
<li>指定路径挂载：<code>-v /宿主机路径:容器内路径</code>。</li>
</ul>
<blockquote>
<p>扩展</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 通过 -v 容器内路径:ro rw改变读写权限</span>
ro <span class="token builtin class-name">readonly</span>	<span class="token comment"># 只读</span>
rw readwrite	<span class="token comment"># 可读可写 </span>

<span class="token comment"># 只要这个设置了容器权限，容器对我们挂载的数据卷内容就有限定了！</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3307</span>:3306 <span class="token parameter variable">--name</span> mysql-test <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> mysql-volume:/etc/mysql:ro <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">333</span> <span class="token punctuation">\</span>
mysql:5.7

<span class="token comment"># ro 说明这个路径只能通过宿主机来操作，容器内部是无法操作的！</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-5-初识Dockefile"><a href="#4-5-初识Dockefile" class="headerlink" title="4.5.初识Dockefile"></a>4.5.初识Dockefile</h3><p>Dockerfile就是用来构建docker image的文件！就是命令脚本！</p>
<p>通过这个脚本可以生成镜像，镜像是一层一层的，脚本一个个的命令，每个命令就是一层。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、创建一个dockerfile文件，名字可以随意</span>

<span class="token comment"># 文件中的内容	指令(大写)  参数	</span>
FROM centos
VOLUME <span class="token punctuation">[</span><span class="token string">"volume01"</span>,<span class="token string">"volume02"</span><span class="token punctuation">]</span>
CMD <span class="token builtin class-name">echo</span> <span class="token string">"---end---"</span>
CMD /bin/bash

<span class="token comment"># 这里每个命令就是镜像的一层</span>

<span class="token comment"># 2、docker build生成镜像 </span>
<span class="token punctuation">[</span>root@mingyu docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker build -f /root/docker-test-volume/dockerfile1 -t mingyu/centos:1.0 . # 这里的这个点表示当前路径下！一定要加</span>
Sending build context to Docker daemon  <span class="token number">2</span>.048kB
Step <span class="token number">1</span>/4 <span class="token builtin class-name">:</span> FROM centos
latest: Pulling from library/centos
6910e5a164f7: Pull complete 
Digest: sha256:4062bbdd1bb0801b0aa38e0f83dece70fb7a5e9bce223423a68de2d8b784b43b
Status: Downloaded newer image <span class="token keyword">for</span> centos:latest
 ---<span class="token operator">></span> 831691599b88
Step <span class="token number">2</span>/4 <span class="token builtin class-name">:</span> VOLUME <span class="token punctuation">[</span><span class="token string">"volume01"</span>,<span class="token string">"volume02"</span><span class="token punctuation">]</span>
 ---<span class="token operator">></span> Running <span class="token keyword">in</span> 2431f66d812c
Removing intermediate container 2431f66d812c
 ---<span class="token operator">></span> d7d82437e882
Step <span class="token number">3</span>/4 <span class="token builtin class-name">:</span> CMD <span class="token builtin class-name">echo</span> <span class="token string">"---end---"</span>
 ---<span class="token operator">></span> Running <span class="token keyword">in</span> 61e1c1e347f4
Removing intermediate container 61e1c1e347f4
 ---<span class="token operator">></span> 9941580f890a
Step <span class="token number">4</span>/4 <span class="token builtin class-name">:</span> CMD /bin/bash
 ---<span class="token operator">></span> Running <span class="token keyword">in</span> c6985be4aaed
Removing intermediate container c6985be4aaed
 ---<span class="token operator">></span> 8adb23ccb590
Successfully built 8adb23ccb590
Successfully tagged mingyu/centos:1.0

<span class="token comment"># 3、启动自己写的容器</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> mycentos mingyu/centos:1.0 /bin/bash

<span class="token comment"># 在容器内部可以看到我们自己定义的容器卷</span>
<span class="token punctuation">[</span>root@26c568f61497 /<span class="token punctuation">]</span><span class="token comment"># ls</span>
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var  volume01	volume02


<span class="token comment"># 4、查看容器的数据卷的挂载位置</span>
<span class="token punctuation">[</span>root@mingyu ~<span class="token punctuation">]</span><span class="token comment"># docker inspect mycentos</span>
<span class="token string">"Mounts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
<span class="token punctuation">&#123;</span>
<span class="token string">"Type"</span><span class="token builtin class-name">:</span> <span class="token string">"volume"</span>,
<span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"ec18f8b7f9a2284071501133ec17c5094093200e372dcf6c5b2bd13fbf4c9f06"</span>,
<span class="token string">"Source"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/volumes/ec18f8b7f9a2284071501133ec17c5094093200e372dcf6c5b2bd13fbf4c9f06/_data"</span>,
<span class="token string">"Destination"</span><span class="token builtin class-name">:</span> <span class="token string">"volume01"</span>,
<span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,
<span class="token string">"Mode"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
<span class="token string">"RW"</span><span class="token builtin class-name">:</span> true,
<span class="token string">"Propagation"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
<span class="token punctuation">&#125;</span>,
<span class="token punctuation">&#123;</span>
<span class="token string">"Type"</span><span class="token builtin class-name">:</span> <span class="token string">"volume"</span>,
<span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"8adb94c9d27174623e188e48652d932889a7d84c33466ab96d2548ee7f9fea72"</span>,
<span class="token string">"Source"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/volumes/8adb94c9d27174623e188e48652d932889a7d84c33466ab96d2548ee7f9fea72/_data"</span>,
<span class="token string">"Destination"</span><span class="token builtin class-name">:</span> <span class="token string">"volume02"</span>,
<span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,
<span class="token string">"Mode"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,
<span class="token string">"RW"</span><span class="token builtin class-name">:</span> true,
<span class="token string">"Propagation"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span>,<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这种方式我们未来使用的十分多，因为我们通常会自己构建自己的镜像！</p>
<p>建设构建镜像时没有挂载卷，需要手动挂载<code> -v 卷名:容器内路径</code>。</p>
<h3 id="4-6-数据卷容器"><a href="#4-6-数据卷容器" class="headerlink" title="4.6.数据卷容器"></a>4.6.数据卷容器</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># mycentos01容器继承mycentos的容器数据卷</span>
<span class="token comment"># mycentos01容器也有mycentos的数据了！</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> mycentos01 --volumes-from mycentos mingyu/centos:1.0 /bin/bash

<span class="token comment"># 测试删除mycentos容器，mycentos01容器仍然可以访问数据卷的数据</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-7-结论"><a href="#4-7-结论" class="headerlink" title="4.7.结论"></a>4.7.结论</h3><ul>
<li>容器之间信息的传递，数据卷的生命周期一直持续到没有容器使用为止。</li>
<li>但是一旦将数据持久化到本地磁盘，本地文件是不会消失的！</li>
</ul>
<h2 id="5-DockerFile"><a href="#5-DockerFile" class="headerlink" title="5.DockerFile"></a>5.DockerFile</h2><h3 id="5-1-Docker镜像的构建步骤"><a href="#5-1-Docker镜像的构建步骤" class="headerlink" title="5.1.Docker镜像的构建步骤"></a>5.1.Docker镜像的构建步骤</h3><ul>
<li>编写一个dockerfile文件。</li>
<li><code>docker build</code>构建成为一个镜像。</li>
<li><code>docker run</code>运行镜像。</li>
<li><code>docker push</code>发布镜像（Docker Hub、阿里云镜像）。</li>
</ul>
<h3 id="5-2-DockerFile构建过程"><a href="#5-2-DockerFile构建过程" class="headerlink" title="5.2.DockerFile构建过程"></a>5.2.DockerFile构建过程</h3><h4 id="5-2-1-基础知识"><a href="#5-2-1-基础知识" class="headerlink" title="5.2.1.基础知识"></a>5.2.1.基础知识</h4><ul>
<li>每个保留关键字（指令）都是必须大写字母。</li>
<li>执行从上到下顺序执行。</li>
<li>#表示注释。</li>
<li>每一个指令都会创建提交一个新的镜像层，并提交。</li>
</ul>
<p><img src="/markdownimages/Docker/7.png" alt="dockerfile指令分层"></p>
<p>dockerfile是面向开发的，我们以后要发布项目，做镜像，就要编写dockerfile文件，这个文件十分简单！</p>
<p>Docker镜像主键成为企业交付的标准，必须掌握！</p>
<h4 id="5-2-2-DockerFile、镜像和容器的关系"><a href="#5-2-2-DockerFile、镜像和容器的关系" class="headerlink" title="5.2.2.DockerFile、镜像和容器的关系"></a>5.2.2.DockerFile、镜像和容器的关系</h4><p>DockerFile：构建文件，定义了一切的步骤，相当于源代码。</p>
<p>DockerImages：通过DockerFile生成的镜像，最终发布和运行的产品。</p>
<p>DockerContainer：容器就是镜像运行起来提供服务的。</p>
<h3 id="5-3-DockerFile指令"><a href="#5-3-DockerFile指令" class="headerlink" title="5.3.DockerFile指令"></a>5.3.DockerFile指令</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM                       <span class="token comment"># 基础镜像，一切从这里开始构建</span>
MAINTAINER                 <span class="token comment"># 镜像是谁写的，姓名+邮箱</span>
RUN                        <span class="token comment"># 镜像构建的时候需要运行的命令</span>
ADD                        <span class="token comment"># 添加内容(自动解压)</span>
WORKDIR                    <span class="token comment"># 镜像的工作目录</span>
VOLUME                     <span class="token comment"># 容器卷的挂载位置</span>
EXPOSE                     <span class="token comment"># 暴露端口</span>
CMD                        <span class="token comment"># 指定容器启动的时候要运行的命令，只有最后一个会生效，可被替代</span>
ENTRYPOINT                 <span class="token comment"># 指定容器启动的时候要运行的命令，可以追加命令</span>
ONBUILD                    <span class="token comment"># 当构建一个被继承 DockerFile 这个时候就会运行ONBUILD指令</span>
COPY                       <span class="token comment"># 类似ADD，将文件拷贝到镜像中</span>
ENV                        <span class="token comment"># 构建的时候设置环境变量</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-4-实战：创建一个自己的CentOS"><a href="#5-4-实战：创建一个自己的CentOS" class="headerlink" title="5.4.实战：创建一个自己的CentOS"></a>5.4.实战：创建一个自己的CentOS</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、编写dockerfile文件</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-centos</span>
FROM centos
MAINTAINER mingyu<span class="token operator">&lt;</span><span class="token number">1790210727</span>@qq.com<span class="token operator">></span>

ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>

RUN yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>
RUN yum <span class="token parameter variable">-y</span> <span class="token function">install</span> net-tools

EXPOSE <span class="token number">80</span>

CMD <span class="token builtin class-name">echo</span> <span class="token variable">$MYPATH</span>
CMD <span class="token builtin class-name">echo</span> <span class="token string">"---end---"</span>
CMD /bin/bash

<span class="token comment"># 2、docker build构建镜像</span>
<span class="token comment"># 语法：docker build -f dockerfile文件路径 -t 镜像名:版本号 .</span>
<span class="token function">docker</span> build <span class="token parameter variable">-f</span> dockerfile-centos <span class="token parameter variable">-t</span> mingyu/centos:2.0 <span class="token builtin class-name">.</span>

<span class="token comment"># 3、查看我们自己构建的镜像</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY          TAG                 IMAGE ID            CREATED              SIZE
mingyu/centos       <span class="token number">2.0</span>                 bab722ff73fc        About a minute ago   287MB

<span class="token comment"># 4、测试运行</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> mycentos mingyu/centos:2.0

<span class="token comment"># 原生的CentOS并没有vim和ifconfig命令，我们自己构建的CentOS是可以用的！</span>

<span class="token comment"># 5、docker history 可以查看镜像的构建步骤</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker history mingyu/centos:2.0</span>
IMAGE               CREATED             CREATED BY                                      SIZE               
bab722ff73fc        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD ["/bin/sh" "-c" "/bin…   0B                 </span>
84744206026b        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD ["/bin/sh" "-c" "echo…   0B                 </span>
1da4606efdce        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD ["/bin/sh" "-c" "echo…   0B                 </span>
cd5031824201        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  EXPOSE 80                    0B                 </span>
773c8a4d5a68        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> net-tools             <span class="token number">14</span>.3MB             
023728153f3b        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>                   <span class="token number">57</span>.1MB             
72a357865b33        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop) WORKDIR /usr/local            0B                 </span>
c248625c78e6        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  ENV MYPATH=/usr/local        0B                 </span>
6fb94cf1eadc        <span class="token number">8</span> minutes ago       /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  MAINTAINER mingyu&lt;1466637…   0B                 </span>
831691599b88        <span class="token number">10</span> days ago         /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  CMD ["/bin/bash"]            0B                 </span>
<span class="token operator">&lt;</span>missing<span class="token operator">></span>           <span class="token number">10</span> days ago         /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop)  LABEL org.label-schema.sc…   0B                 </span>
<span class="token operator">&lt;</span>missing<span class="token operator">></span>           <span class="token number">10</span> days ago         /bin/sh <span class="token parameter variable">-c</span> <span class="token comment">#(nop) ADD file:84700c11fcc969ac0…   215MB    </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-5-CMD和ENTRYPOINT"><a href="#5-5-CMD和ENTRYPOINT" class="headerlink" title="5.5.CMD和ENTRYPOINT"></a>5.5.CMD和ENTRYPOINT</h3><blockquote>
<p>测试CMD</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">CMD                        <span class="token comment"># 指定容器启动的时候要运行的命令，只有最后一个CMD会生效，可被替代</span>
ENTRYPOINT                 <span class="token comment"># 指定容器启动的时候要运行的命令，可以追加命令</span>

<span class="token comment"># 1、写dockerfile文件</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-cmd-test</span>
FROM centos
CMD <span class="token punctuation">[</span><span class="token string">"ls"</span>,<span class="token string">"-a"</span><span class="token punctuation">]</span>

<span class="token comment"># 2、构建测试镜像</span>
<span class="token function">docker</span> build <span class="token parameter variable">-f</span> dockerfile-cmd-test <span class="token parameter variable">-t</span> test/cmd:1.0 <span class="token builtin class-name">.</span>

<span class="token comment"># 3、查看构建好的镜像</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
test/cmd            <span class="token number">1.0</span>                 df29f1d322e7        <span class="token number">4</span> minutes ago       215MB

<span class="token comment"># 4、启动测试镜像 发现我们ls -a命令生效</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run -it --name test-cmd test/cmd:1.0</span>
<span class="token builtin class-name">.</span>   .dockerenv	dev  home  lib64       media  opt   root  sbin	sys  usr
<span class="token punctuation">..</span>  bin		etc  lib   lost+found  mnt    proc  run   srv	tmp  var

<span class="token comment"># 5、测试追加命令 结果失败 o(╥﹏╥)o</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run -it --name test-cmd test/cmd:1.0 -l</span>
docker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused <span class="token string">"exec: <span class="token entity" title="\&quot;">\"</span>-l<span class="token entity" title="\&quot;">\"</span>: executable file not found in <span class="token environment constant">$PATH</span>"</span><span class="token builtin class-name">:</span> unknown.

<span class="token comment"># 6、原因：用CMD的情况下 -l 替换了 CMD ["ls","-a"]，-l不是命令所以就报错了！</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>测试ENTRYPOINT</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">CMD                        <span class="token comment"># 指定容器启动的时候要运行的命令，只有最后一个CMD会生效，可被替代</span>
ENTRYPOINT                 <span class="token comment"># 指定容器启动的时候要运行的命令，可以追加命令</span>

<span class="token comment"># 1、写dockerfile文件</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># vim dockerfile-entrypoint-test</span>
FROM centos
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"ls"</span>,<span class="token string">"-a"</span><span class="token punctuation">]</span>

<span class="token comment"># 2、构建测试镜像</span>
<span class="token function">docker</span> build <span class="token parameter variable">-f</span> dockerfile-entrypoint-test <span class="token parameter variable">-t</span> test/entrypoint:1.0 <span class="token builtin class-name">.</span>

<span class="token comment"># 3、查看构建好的镜像</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
test/entrypoint     <span class="token number">1.0</span>                 6ede8cb2383f        <span class="token number">31</span> seconds ago      215MB

<span class="token comment"># 4、启动测试镜像 发现我们ls -a命令生效</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run --name test-entrypoint -it test/entrypoint:1.0</span>
<span class="token builtin class-name">.</span>   .dockerenv	dev  home  lib64       media  opt   root  sbin	sys  usr
<span class="token punctuation">..</span>  bin		etc  lib   lost+found  mnt    proc  run   srv	tmp  var

<span class="token comment"># 5、测试追加命令 成功了 (*^▽^*)</span>
<span class="token punctuation">[</span>root@mingyu dockerfile<span class="token punctuation">]</span><span class="token comment"># docker run --name test-entrypoint1 -it test/entrypoint:1.0 -l</span>
total <span class="token number">56</span>
drwxr-xr-x  <span class="token number">1</span> root root <span class="token number">4096</span> Jun <span class="token number">27</span> 05:58 <span class="token builtin class-name">.</span>
drwxr-xr-x  <span class="token number">1</span> root root <span class="token number">4096</span> Jun <span class="token number">27</span> 05:58 <span class="token punctuation">..</span>
-rwxr-xr-x  <span class="token number">1</span> root root    <span class="token number">0</span> Jun <span class="token number">27</span> 05:58 .dockerenv
lrwxrwxrwx  <span class="token number">1</span> root root    <span class="token number">7</span> May <span class="token number">11</span>  <span class="token number">2019</span> bin -<span class="token operator">></span> usr/bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-6-实战：Tomcat镜像"><a href="#5-6-实战：Tomcat镜像" class="headerlink" title="5.6.实战：Tomcat镜像"></a>5.6.实战：Tomcat镜像</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、准备jdk压缩包和tomcat压缩包</span>
jdk-8u251-linux-x64.tar.gz
apache-tomcat-9.0.36.tar.gz

<span class="token comment"># 2、编写dockerfile文件</span>
FROM centos
MAINTAINER mingyu<span class="token operator">&lt;</span><span class="token number">1790210727</span>@qq.com<span class="token operator">></span>

ADD /opt/java/jdk-8u251-linux-x64.tar.gz /usr/local/
ADD /opt/tomcat/apache-tomcat-9.0.36.tar.gz /usr/local/

RUN yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">vim</span>

ENV MYPATH /usr/local
WORKDIR <span class="token variable">$MYPATH</span>

ENV JAVA_HOME /usr/local/jdk1.8.0_251
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar

ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.36
ENV CATALINA_BASH /usr/local/apache-tomcat-9.0.36
ENV <span class="token environment constant">PATH</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$CATALINA_HOME</span>/lib:<span class="token variable">$CATALINA_HOME</span>/bin

EXPOSE <span class="token number">8080</span>

CMD /usr/local/apache-tomcat-9.0.36/bin/startup.sh <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-7-小结"><a href="#5-7-小结" class="headerlink" title="5.7.小结"></a>5.7.小结</h3><p><img src="/markdownimages/Docker/7.png" alt="docker流程"></p>
<h2 id="6-Docker网络"><a href="#6-Docker网络" class="headerlink" title="6.Docker网络"></a>6.Docker网络</h2><h3 id="6-1-理解Docker网络"><a href="#6-1-理解Docker网络" class="headerlink" title="6.1.理解Docker网络"></a>6.1.理解Docker网络</h3><blockquote>
<p>查看网络环境</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@mingyu tomcat<span class="token punctuation">]</span><span class="token comment"># ifconfig</span>
docker0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">></span>  mtu <span class="token number">1500</span>
        inet <span class="token number">172.18</span>.0.1  netmask <span class="token number">255.255</span>.0.0  broadcast <span class="token number">172.18</span>.255.255
        ether 02:42:f4:c7:a9:d2  txqueuelen <span class="token number">0</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">615374</span>  bytes <span class="token number">214760761</span> <span class="token punctuation">(</span><span class="token number">204.8</span> MiB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">1059269</span>  bytes <span class="token number">132175026</span> <span class="token punctuation">(</span><span class="token number">126.0</span> MiB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

eth0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">></span>  mtu <span class="token number">1500</span>
        inet <span class="token number">172.17</span>.95.30  netmask <span class="token number">255.255</span>.240.0  broadcast <span class="token number">172.17</span>.95.255
        ether 00:16:3e:34:40:89  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">1358134</span>  bytes <span class="token number">713636205</span> <span class="token punctuation">(</span><span class="token number">680.5</span> MiB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">1049543</span>  bytes <span class="token number">319209059</span> <span class="token punctuation">(</span><span class="token number">304.4</span> MiB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

lo: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">7</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class="token operator">></span>  mtu <span class="token number">65536</span>
        inet <span class="token number">127.0</span>.0.1  netmask <span class="token number">255.0</span>.0.0
        loop  txqueuelen <span class="token number">1</span>  <span class="token punctuation">(</span>Local Loopback<span class="token punctuation">)</span>
        RX packets <span class="token number">1387986</span>  bytes <span class="token number">260874723</span> <span class="token punctuation">(</span><span class="token number">248.7</span> MiB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">1387986</span>  bytes <span class="token number">260874723</span> <span class="token punctuation">(</span><span class="token number">248.7</span> MiB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>docker0</code>：docker的地址。</li>
<li><code>lo</code>：本机地址。</li>
<li><code>eth0</code>：阿里云内网地址。</li>
</ul>
<blockquote>
<p>原理</p>
</blockquote>
<ul>
<li>我们只要安装了docker就会安装一个网卡docker0，每启动一个docker容器，docker就会给docker容器分配一个ip ,桥接模式。</li>
<li>启动的容器带来的网卡都是一对对的。</li>
<li><code>veth-pair</code>技术就是一对虚拟设备接口，他们都是成对出现的，一端连着协议，一端彼此相连。</li>
<li>正因为有<code>veth-pair</code>的特性，<code>veth-pair</code>可以充当桥梁，连接各种虚拟网络设备。</li>
</ul>
<p><img src="/markdownimages/Docker/9.png" alt="docker网络"></p>
<h3 id="6-2-查看Docker网络"><a href="#6-2-查看Docker网络" class="headerlink" title="6.2.查看Docker网络"></a>6.2.查看Docker网络</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、docker network ls 查看所有的docker网络</span>
<span class="token punctuation">[</span>root@mingyu ~<span class="token punctuation">]</span><span class="token comment"># docker network ls</span>
NETWORK ID          NAME                DRIVER              SCOPE
8ae116b000e5        bridge              bridge              <span class="token builtin class-name">local</span>
18feddce366c        <span class="token function">host</span>                <span class="token function">host</span>                <span class="token builtin class-name">local</span>
5cfab10d71d0        none                null                <span class="token builtin class-name">local</span>

<span class="token comment"># 2、查看具体的docker网络信息</span>
<span class="token function">docker</span> network inspect <span class="token punctuation">[</span>NETWORK ID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-3-自定义网络"><a href="#6-3-自定义网络" class="headerlink" title="6.3.自定义网络"></a>6.3.自定义网络</h3><h4 id="6-3-1-网络模式"><a href="#6-3-1-网络模式" class="headerlink" title="6.3.1.网络模式"></a>6.3.1.网络模式</h4><ul>
<li><code>bridge</code>：桥接模式（默认，自定义网络也用桥接模式）。</li>
<li><code>none</code>：不配网络，一般不用。</li>
<li><code>host</code>：主机模式，和宿主机共享网络。</li>
<li><code>container</code>：容器间直接连通（用的少）。</li>
</ul>
<h4 id="6-3-2-创建网络"><a href="#6-3-2-创建网络" class="headerlink" title="6.3.2.创建网络"></a>6.3.2.创建网络</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、我们直接启动的命令 --net bridge，这个就是我们的docker0</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> p <span class="token parameter variable">--name</span> tomcat01 <span class="token parameter variable">--net</span> bridge tomcat

<span class="token comment"># 2、docker0特点：默认，域名不能访问</span>

<span class="token comment"># 3、自定义网络</span>
<span class="token comment"># --driver	网络模式</span>
<span class="token comment"># --subnet	子网掩码</span>
<span class="token comment"># --gateway	默认网关</span>
<span class="token function">docker</span> network create <span class="token parameter variable">--driver</span> bridge <span class="token parameter variable">--subnet</span> <span class="token number">192.168</span>.0.0/16 <span class="token parameter variable">--gateway</span> <span class="token number">192.168</span>.0.1 mynetwork

<span class="token comment"># 4、查看自己创建的网络</span>
<span class="token punctuation">[</span>root@mingyu ~<span class="token punctuation">]</span><span class="token comment"># docker network ls</span>
NETWORK ID          NAME                DRIVER              SCOPE
8ae116b000e5        bridge              bridge              <span class="token builtin class-name">local</span>
18feddce366c        <span class="token function">host</span>                <span class="token function">host</span>                <span class="token builtin class-name">local</span>
625963e16231        mynetwork           bridge              <span class="token builtin class-name">local</span>
5cfab10d71d0        none                null                <span class="token builtin class-name">local</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="6-3-3-自定义网络的好处"><a href="#6-3-3-自定义网络的好处" class="headerlink" title="6.3.3.自定义网络的好处"></a>6.3.3.自定义网络的好处</h4><ul>
<li><p>使用docker0网络，容器和容器之间只能通过IP地址来ping通，不能使用容器名字来ping。</p>
</li>
<li><p>我们自定义网络，容器之间不仅可以使用IP地址来通信，而且可以使用容器名字来通信。</p>
</li>
<li><p>不同的集群可以使用不同的网络，保证集群式安全和健康的。</p>
</li>
</ul>
<h3 id="6-4-网络联通"><a href="#6-4-网络联通" class="headerlink" title="6.4.网络联通"></a>6.4.网络联通</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># docker network connect</span>
<span class="token punctuation">[</span>root@mingyu ~<span class="token punctuation">]</span><span class="token comment"># docker network --help</span>
Usage:	<span class="token function">docker</span> network COMMAND
Manage networks
Commands:
  connect     Connect a container to a network

<span class="token comment"># docker network connect 语法</span>
<span class="token function">docker</span> network connect NETWORK CONTAINER

<span class="token comment"># 联通之后就是将CONTAINER放到了NETWORK下</span>

<span class="token comment"># 一个容器两个IP</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="7-SpringBoot微服务打包成镜像"><a href="#7-SpringBoot微服务打包成镜像" class="headerlink" title="7.SpringBoot微服务打包成镜像"></a>7.SpringBoot微服务打包成镜像</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1、构建SpringBoot项目。</span>

<span class="token comment"># 2、打包应用。</span>

<span class="token comment"># 3、编写dockerfile。</span>
FROM java:8
EXPOSE <span class="token number">8080</span>

VOLUME /tmp
ADD renren-fast.jar  /app.jar
RUN <span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">'touch /app.jar'</span>
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"java"</span>,<span class="token string">"-jar"</span>,<span class="token string">"/app.jar"</span><span class="token punctuation">]</span>

<span class="token comment"># 4、将Dockerfile和jar上传到服务器上同一层目录下</span>

<span class="token comment"># 5、构建镜像</span>
<span class="token function">docker</span> build <span class="token parameter variable">-f</span> Dockerfile <span class="token parameter variable">-t</span> mingyu/renren-fast:1.0 <span class="token builtin class-name">.</span>

<span class="token comment"># 6、启动镜像</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> renren-fast <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 <span class="token punctuation">\</span>
<span class="token parameter variable">-v</span> /root/idea/renren-fast/tmp:/tmp <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> mingyu/renren-fast:1.0

<span class="token comment"># 7、访问服务器地址</span>
http://xxx.xxx.xxx.xxx:8080/renren-fast/sys/user/info<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> build <span class="token parameter variable">-f</span> Dockerfile <span class="token parameter variable">-t</span> vhr-web:1.0 <span class="token builtin class-name">.</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> vhr-web <span class="token parameter variable">-p</span> <span class="token number">8001</span>:8001 <span class="token parameter variable">-d</span> vhr-web:1.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Anubis</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://AnubisCL.github.io/2024/01/24/Docker/">https://AnubisCL.github.io/2024/01/24/Docker/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Anubis</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Docker/">
                                    <span class="chip bg-color">Docker</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    /*小屏幕下(手机类)的样式*/
    @media only screen and (max-width: 601px) {
        #vcomments textarea {
            box-sizing: border-box;
            background: url("/medias/favicon2.png")  no-repeat right center/30% 70%;
        }
    }

    /*中等屏幕下(平板类)的样式*/
    @media only screen and (min-width: 600px) and (max-width: 992px) {
        #vcomments textarea {
            box-sizing: border-box;
            background: url("/medias/favicon2.png")  no-repeat right center/13% 77%;
        }
    }

    /*大屏幕下(桌面类)的样式*/
    @media only screen and (min-width: 993px) {
        #vcomments textarea {
            box-sizing: border-box;
            background: url("/medias/favicon2.png")  no-repeat right center/15% 80%
        }
    }


    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'MBGgrwA8oTuuftEAqiCOZVHK-gzGzoHsz',
        appKey: '02J2BGbOHURUn7QwpmLO9RUj',
        serverURLs: '',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: '评论区',
        recordIP: 'true'
    });
</script>

<!--Qmsg 推送-->

<script>
    var pushLink ="https://qmsg.zendee.cn/send/d46fe682bce517b9236e4cb4e177df32";
    <!--var siteName = "Anubis's Blog";-->
    var valineButton=document.getElementsByClassName("vsubmit vbtn")[0];
    // var title = siteName + "上又有新评论啦~!\n";

    function send_valine() {
      //获取元素信息
      var pageurl = document.URL;
      var pagename = document.title;
      var pushtime = new Date();
      var vnick = document.getElementsByClassName("vnick vinput")[0].value;
      var vmail = document.getElementsByClassName("vmail vinput")[0].value;
      var vlink = document.getElementsByClassName("vlink vinput")[0].value;
      var veditor = document.getElementsByClassName("veditor vinput")[0].value;
      let content = "有新的评论==>" +
        "昵称：" + vnick +
        " ,文章标题：" + pagename +
        " ,评论内容：" + veditor +
        " ,评论时间：" + pushtime.toLocaleString();
        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/x-www-form-urlencoded");
        var urlencoded = new URLSearchParams();
        urlencoded.append("msg", content);
        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: urlencoded,
            redirect: 'follow'
        };
        fetch(pushLink, requestOptions)
            .then(response => response.text())
            .then(result => console.log(result))
            .catch(error => console.log('error', error));
    }

    //监听
    document.body.addEventListener('click', function(e) {
    if(e.target.className.indexOf('vsubmit') === -1) {
      return;
    }
    send_valine();
  })
</script>


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2024/01/24/%E9%9B%B6%E6%8B%B7%E8%B4%9D/">
                    <div class="card-image">
                        
                        <img src="/markdownimages/background/animation/15.jpg" class="responsive-img" alt="零拷贝">
                        
                        <span class="card-title">零拷贝</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            零拷贝
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-01-24
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E9%9B%B6%E6%8B%B7%E8%B4%9D/" class="post-category">
                                    零拷贝
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
                        <span class="chip bg-color">操作系统</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                本篇&nbsp;<i class="far fa-dot-circle"></i>
            </div>
            <div class="card">
                <a href="/2024/01/24/Docker/">
                    <div class="card-image">
                        
                        <img src="/markdownimages/background/animation/11.jpg" class="responsive-img" alt="Docker">
                        
                        <span class="card-title">Docker</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Docker 操作笔记
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-01-24
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E9%83%A8%E7%BD%B2/" class="post-category">
                                    部署
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Docker/">
                        <span class="chip bg-color">Docker</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="8739548472"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='list'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2024</span>
            
            <a href="/about" target="_blank">Anubis</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/AnubisCL" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:anubiscl@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1790210727" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1790210727" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="https://weibo.com/anubiscl" class="tooltipped" target="_blank" data-tooltip="关注我的微博: https://weibo.com/anubiscl" data-position="top" data-delay="50">
        <i class="fab fa-weibo"></i>
    </a>



    <a href="https://www.zhihu.com/people/anubiszhu-cl" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/anubiszhu-cl" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a>



</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://AnubisCL.github.io"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    
        
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/sakura-half.js"><\/script>');
            }
        </script>
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":190,"height":310},"mobile":{"show":true},"react":{"opacity":0.8},"dialog":{"enable":false,"hitokoto":false,"script":[{"every idle 5s":"$hitokoto$"},{"hover .star":"星星在天上而你在我心里 (*/ω＼*)"},{"tap body":"害羞?(? ???ω??? ?)?"},{"tap face":"不要!（QAQ）"}]},"log":false});</script></body>

</html>
